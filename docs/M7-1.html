<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 7: Lake Ecosystem Dynamics | Environmental Dynamics Workbook</title>
  <meta name="description" content="The online Environmental Dynamics Workbook" />
  <meta name="generator" content="bookdown 0.21.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 7: Lake Ecosystem Dynamics | Environmental Dynamics Workbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The online Environmental Dynamics Workbook" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 7: Lake Ecosystem Dynamics | Environmental Dynamics Workbook" />
  
  <meta name="twitter:description" content="The online Environmental Dynamics Workbook" />
  

<meta name="author" content="Matt Hipsey, Dan Paraska, Alanna Kursar, Giles Knight" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="M6-1.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="https://hypothes.is/embed.js" async></script>
  


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>Environmental Dynamics Workbook</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html"><i class="fa fa-check"></i>Getting Started</a>
<ul>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#excel"><i class="fa fa-check"></i>Excel</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#r"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="GettingStarted.html"><a href="GettingStarted.html#unzipping-files"><i class="fa fa-check"></i>Unzipping files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html"><i class="fa fa-check"></i>Module 1: Modelling in Excel</a>
<ul>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_3"><i class="fa fa-check"></i>What are environmental flows?</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_4"><i class="fa fa-check"></i>Flow diversion case study: Robe Lakes</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_5"><i class="fa fa-check"></i>Module resources</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_6"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_7"><i class="fa fa-check"></i>Flow diversion scenarios</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_8"><i class="fa fa-check"></i>Assessing impacts on lake salinity</a></li>
<li class="chapter" data-level="" data-path="M1-1.html"><a href="M1-1.html#M1_9"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html"><i class="fa fa-check"></i>Module 2: Biogeochemistry</a>
<ul>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html#M2_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html#M2_3"><i class="fa fa-check"></i>Modelling concepts</a></li>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html#M2_4"><i class="fa fa-check"></i>Organic matter oxidation</a></li>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html#M2_5"><i class="fa fa-check"></i>Module resources</a></li>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html#M2_6"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="M2-1.html"><a href="M2-1.html#M2_9"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html"><i class="fa fa-check"></i>Module 3: Climate Modeling</a>
<ul>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html#M3_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html#M2_14"><i class="fa fa-check"></i>Module resources</a></li>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html#M3_3"><i class="fa fa-check"></i>Case Study 1: A “Zero-Dimensional” Energy Balance Model</a></li>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html#M3_7"><i class="fa fa-check"></i>Case Study 2: A “Quick Fix”</a></li>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html#M3_9"><i class="fa fa-check"></i>Case Study 3: Incorporating Greenhouse Gases</a></li>
<li class="chapter" data-level="" data-path="M3-1.html"><a href="M3-1.html#M3_13"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html"><i class="fa fa-check"></i>Module 4: Ocean Acidification</a>
<ul>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_3"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#module-resources"><i class="fa fa-check"></i>Module resources</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_4"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_5"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_6"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_7"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="M4-1.html"><a href="M4-1.html#M4_8"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html"><i class="fa fa-check"></i>Module 5a: Catchment Water Balance</a>
<ul>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_3"><i class="fa fa-check"></i>The Water Balance Approach</a></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_22"><i class="fa fa-check"></i>Module resources</a></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_4"><i class="fa fa-check"></i>Water Balance Model</a></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_11"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_12"><i class="fa fa-check"></i>Equations</a></li>
<li class="chapter" data-level="" data-path="M5A-1.html"><a href="M5A-1.html#M5A_21"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M5B-1.html"><a href="M5B-1.html"><i class="fa fa-check"></i>Module 5b: Land Use and Nutrient Management</a>
<ul>
<li class="chapter" data-level="" data-path="M5B-1.html"><a href="M5B-1.html#M5B_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M5B-1.html"><a href="M5B-1.html#M5B_3"><i class="fa fa-check"></i>Model Overview</a></li>
<li class="chapter" data-level="" data-path="M5B-1.html"><a href="M5B-1.html#M5B_4"><i class="fa fa-check"></i>Module Resources</a></li>
<li class="chapter" data-level="" data-path="M5B-1.html"><a href="M5B-1.html#M5B_5"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="M5B-1.html"><a href="M5B-1.html#M5B_10"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M6-1.html"><a href="M6-1.html"><i class="fa fa-check"></i>Module 6: River Pollution</a>
<ul>
<li class="chapter" data-level="" data-path="M6-1.html"><a href="M6-1.html#M6_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M6-1.html"><a href="M6-1.html#M6_3"><i class="fa fa-check"></i>Advection-Dispersion Reaction</a></li>
<li class="chapter" data-level="" data-path="M6-1.html"><a href="M6-1.html#M6_4"><i class="fa fa-check"></i>Module Resources</a></li>
<li class="chapter" data-level="" data-path="M6-1.html"><a href="M6-1.html#M6_5"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="M6-1.html"><a href="M6-1.html#M6_6"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html"><i class="fa fa-check"></i>Module 7: Lake Ecosystem Dynamics</a>
<ul>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html#M7_2"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html#M7_3"><i class="fa fa-check"></i>Module Resources</a></li>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html#M7_4"><i class="fa fa-check"></i>Setting up GLM</a></li>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html#M7_8"><i class="fa fa-check"></i>Configuring Model Parameters</a></li>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html#M7_9"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="M7-1.html"><a href="M7-1.html#M7_13"><i class="fa fa-check"></i>Submission</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Dynamics Workbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="M7_1" class="section level1 unnumbered">
<h1>Module 7: Lake Ecosystem Dynamics</h1>
<div id="M7_2" class="section level3 unnumbered">
<h3>Objectives</h3>
<p>To use the GLM model to investigate water quality modelling in lakes and to incorporate a coupled hydrodynamic-biogeochemical model.</p>
</div>
<div id="M7_3" class="section level3 unnumbered">
<h3>Module Resources</h3>
<p>Download the GLM files for this module by clicking the download button in the tool bar <i class="fa fa-download" aria-hidden="true"></i>.</p>
</div>
<div id="M7_4" class="section level3 unnumbered">
<h3>Setting up GLM</h3>
<div id="M7_5" class="section level4 unnumbered">
<h4>Running GLM on macOS</h4>
<ul>
<li>Open the Terminal application on your Mac</li>
<li>Use the <code>cd</code> (change directory) command to navigate to the <em>Kinneret97</em> folder</li>
<li>In Finder, go to the macGLM folder and right-click on the glm app, select <em>Show Package Contents</em></li>
<li>Enter the Contents folder then the MacOS folder, and locate the glm executable file</li>
<li>Back in terminal, enter the file path for this executable file - you can do this by dragging/dropping the file into the terminal</li>
<li>Leave a space after the file path and type <code>--xdisp</code></li>
<li>Press Enter and the model will open</li>
</ul>
<center>
<video width="100%" height="100%" controls>
<source src="images/module7/video1.mp4" type="video/mp4">
</video>
</center>

<div class="rmdnote2">
Your Mac may block opening GLM the first time you run it. If this occurs, go to your Security options inside System Preferences and click ‘Open Anyway.’
</div>
</div>
<div id="M7_6" class="section level4 unnumbered">
<h4>Running GLM on Windows</h4>
<p>On Windows, the model can be run using a batch-file <code>glm.bat</code>, which you can double click from in the <em>Kinneret97</em> directory. The <code>.bat</code> file calls the GLM model from the current working directory.</p>

<div class="rmdnote2">
<p>If the model is not opening make sure you’re <strong>not</strong> working in a network directory (e.g. OneDrive) and the file path to the <code>glm.bat</code> file has <strong>zero</strong> spaces in it.</p>
</div>
</div>
<div id="M7_7" class="section level4 unnumbered">
<h4>Running GLM in RStudio</h4>
<p>If you want to use RStudio, open the R Project, then each of the R files: <code>Get started.R</code>, <code>Change parameters.R</code> and <code>Plot.R</code>. Run the lines in <code>Get started.R</code> - it will download all the R packages from the internet, as well as an old version of GLM.</p>
<p>To get the latest version of GLM, paste the <em>winGLM</em> folder into the place where R has saved its old version of <em>winGLM</em>, for example, <code>H:/My Documents/R/win-library/3.4/GLMr/extbin/winGLM</code>. After that you can drive the model and plot everything using the other two scripts.</p>

<div class="rmdnote2">
GLM will not run on any versions of R newer than 4.0
</div>
</div>
</div>
<div id="M7_8" class="section level3 unnumbered">
<h3>Configuring Model Parameters</h3>
<p>To configure the model, open the <code>glm3.nml</code> file in the <em>Kinneret97</em> directory with a text editor. A chunk of this <code>.nml</code> file is shown below. For example, if you wanted to change the maximum number of lake layers the model simulates, you would change <code>max_layers = 500</code>.</p>

<div class="rmdnote2">
The easiest way to edit the <em>glm3.nml</em> file is with the Atom text editor. You can download it <a href="https://atom.io">here</a>.
</div>
<style type="text/css">
.sourceCode {
max-height: 400px;
overflow-y: auto !important;
background-color: inherit;
}
</style>
<div class="sourceCode" id="cb2"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb2-1"><a href="M7-1.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">!------------------------------------------------------------------------------!</span></span>
<span id="cb2-2"><a href="M7-1.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">!                                                                              !</span></span>
<span id="cb2-3"><a href="M7-1.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">!          .----------------.  .----------------.  .----------------.          !</span></span>
<span id="cb2-4"><a href="M7-1.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">!          | .--------------. || .--------------. || .--------------. |        !</span></span>
<span id="cb2-5"><a href="M7-1.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">!          | |    ______    | || |   _____      | || | ____    ____ | |        !</span></span>
<span id="cb2-6"><a href="M7-1.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">!          | |  .&#39; ___  |   | || |  |_   _|     | || ||_   \  /   _|| |        !</span></span>
<span id="cb2-7"><a href="M7-1.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">!          | | / .&#39;   \_|   | || |    | |       | || |  |   \/   |  | |        !</span></span>
<span id="cb2-8"><a href="M7-1.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">!          | | | |    ____  | || |    | |   _   | || |  | |\  /| |  | |        !</span></span>
<span id="cb2-9"><a href="M7-1.html#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">!          | | \ `.___]  _| | || |   _| |__/ |  | || | _| |_\/_| |_ | |        !</span></span>
<span id="cb2-10"><a href="M7-1.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">!          | |  `._____.&#39;   | || |  |________|  | || ||_____||_____|| |        !</span></span>
<span id="cb2-11"><a href="M7-1.html#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">!          | |              | || |              | || |              | |        !</span></span>
<span id="cb2-12"><a href="M7-1.html#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">!          | &#39;--------------&#39; || &#39;--------------&#39; || &#39;--------------&#39; |        !</span></span>
<span id="cb2-13"><a href="M7-1.html#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">!          &#39;----------------&#39;  &#39;----------------&#39;  &#39;----------------&#39;          !</span></span>
<span id="cb2-14"><a href="M7-1.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">!                                                                              !</span></span>
<span id="cb2-15"><a href="M7-1.html#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb2-16"><a href="M7-1.html#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="M7-1.html#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb2-18"><a href="M7-1.html#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">! general model setup</span></span>
<span id="cb2-19"><a href="M7-1.html#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb2-20"><a href="M7-1.html#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>glm_setup</span>
<span id="cb2-21"><a href="M7-1.html#cb2-21" aria-hidden="true" tabindex="-1"></a>   sim_name <span class="kw">=</span> <span class="st">&#39;Example Kinneret GLM Simulation&#39;</span></span>
<span id="cb2-22"><a href="M7-1.html#cb2-22" aria-hidden="true" tabindex="-1"></a>   max_layers <span class="kw">=</span> <span class="dv">500</span></span>
<span id="cb2-23"><a href="M7-1.html#cb2-23" aria-hidden="true" tabindex="-1"></a>   min_layer_vol <span class="kw">=</span> <span class="fl">0.025</span></span>
<span id="cb2-24"><a href="M7-1.html#cb2-24" aria-hidden="true" tabindex="-1"></a>   min_layer_thick <span class="kw">=</span> <span class="fl">0.15</span></span>
<span id="cb2-25"><a href="M7-1.html#cb2-25" aria-hidden="true" tabindex="-1"></a>   max_layer_thick <span class="kw">=</span> <span class="fl">1.50</span></span>
<span id="cb2-26"><a href="M7-1.html#cb2-26" aria-hidden="true" tabindex="-1"></a>   density_model <span class="kw">=</span> <span class="dv">1</span></span>
<span id="cb2-27"><a href="M7-1.html#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="kw">/</span></span></code></pre></div>
</div>
<div id="M7_9" class="section level3 unnumbered">
<h3>Exercises</h3>
<div id="M7_10" class="section level4 unnumbered">
<h4>Lake Stratification</h4>
<p>The simulation in the <em>Kinneret97</em> directory is an example 40m deep, monomictic lake that is used to supply drinking water and support an active fishery.</p>
<p>Before running the model, open the file <code>glm3.nml</code> in a text editor and inspect the model setup etc. This file is the main configuration file that drives the model. The file <code>glm3.nml</code> has several key sections in it related to the model domain and parameters, the sources of boundary condition data, and details of outputs. Scan the parameters, e.g. number of layers, light extinction coefficient, mixing coefficient etc.</p>
<p>Once the model has run, you can inspect the results. There are three ways to look at output:</p>
<ul>
<li>Via the time-depth contour plots that appear during the run (configured via <code>plots.nml</code>)</li>
<li>Further information on the daily water and energy balance is in the output file <code>lake.csv</code></li>
<li>Time series values of selected state variables (e.g. temperature, salinity, etc…) can be requested for a specific depth (depth above bottom) – this is setup in <code>&amp;outputs</code> (eg. <code>WQ_5.csv</code>)</li>
</ul>
<ol style="list-style-type: decimal">
<li>Draw a schematic picture of the lake, the relevant boundary conditions (both related to water fluxes and energy fluxes).</li>
<li>Identify and open the boundary condition input files - these are csv files containing time-series of meteorological information, and inflow and outflow volumes. These files can be opened in Excel or a text-editor. Find where these files are called from within <code>glm3.nml</code>.</li>
<li>Plot the lake water balance – volume, water level and fluxes including inflows, outflows, rainfall and evaporation (refer to columns in <code>lake.csv</code>, and copy the appropriate data into your own excel spreadsheet).</li>
</ol>
<center>
<div class="figure"><span id="fig:figM7-1"></span>
<img src="images/module7/picture2.png" alt="Schematic diagram of water balance components." width="75%" />
<p class="caption">
Figure 11: Schematic diagram of water balance components.
</p>
</div>
</center>
<!-- add in equation from slide -->
<ol start="4" style="list-style-type: decimal">
<li>Plot the surface heat fluxes such as shortwave, longwave, sensible heat latent heat (refer to columns in <code>lake.csv</code>).</li>
</ol>
<center>
<div class="figure"><span id="fig:figM7-2"></span>
<img src="images/module7/picture3.png" alt="Schematic diagram of surface heat fluxes impacting lake water temperature. For a description of the heat flux terms refer to the [GLM paper](https://gmd.copernicus.org/articles/12/473/2019/)" width="75%" />
<p class="caption">
Figure 12: Schematic diagram of surface heat fluxes impacting lake water temperature. For a description of the heat flux terms refer to the <a href="https://gmd.copernicus.org/articles/12/473/2019/">GLM paper</a>
</p>
</div>
</center>
<ol start="5" style="list-style-type: decimal">
<li>Go to the <code>&amp;output</code> section of <code>glm3.nml</code> and customize the configuration to make two output files, one at 5m from the bottom (ie. in the lake hypolimnion) and one at 35m from the bottom (ie. in the lake epilimnion). This create two <code>.csv</code> files (<code>WQ_5.csv</code> and <code>WQ_35.csv</code>) with conditions at these water depths. Plot the temperate of the two layers in excel. Identify the periods where the lake is stratified and mixed.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb3-1"><a href="M7-1.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb3-2"><a href="M7-1.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">! format for output and filename(s)</span></span>
<span id="cb3-3"><a href="M7-1.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb3-4"><a href="M7-1.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>output</span>
<span id="cb3-5"><a href="M7-1.html#cb3-5" aria-hidden="true" tabindex="-1"></a>   out_dir <span class="kw">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb3-6"><a href="M7-1.html#cb3-6" aria-hidden="true" tabindex="-1"></a>   out_fn  <span class="kw">=</span> <span class="st">&#39;output&#39;</span></span>
<span id="cb3-7"><a href="M7-1.html#cb3-7" aria-hidden="true" tabindex="-1"></a>   nsave <span class="kw">=</span> <span class="dv">6</span>  <span class="co">!This will output every 6 hours</span></span>
<span id="cb3-8"><a href="M7-1.html#cb3-8" aria-hidden="true" tabindex="-1"></a>   <span class="co">! General summary file</span></span>
<span id="cb3-9"><a href="M7-1.html#cb3-9" aria-hidden="true" tabindex="-1"></a>   csv_lake_fname <span class="kw">=</span> <span class="st">&#39;lake&#39;</span></span>
<span id="cb3-10"><a href="M7-1.html#cb3-10" aria-hidden="true" tabindex="-1"></a>   <span class="co">! Depth specific outputs</span></span>
<span id="cb3-11"><a href="M7-1.html#cb3-11" aria-hidden="true" tabindex="-1"></a>   csv_point_nlevs <span class="kw">=</span> <span class="dv">2</span> </span>
<span id="cb3-12"><a href="M7-1.html#cb3-12" aria-hidden="true" tabindex="-1"></a>   csv_point_fname <span class="kw">=</span> <span class="st">&#39;WQ_&#39;</span></span>
<span id="cb3-13"><a href="M7-1.html#cb3-13" aria-hidden="true" tabindex="-1"></a>   csv_point_at <span class="kw">=</span> <span class="fl">5.</span>,<span class="fl">35.</span></span>
<span id="cb3-14"><a href="M7-1.html#cb3-14" aria-hidden="true" tabindex="-1"></a>   csv_point_nvars <span class="kw">=</span> <span class="dv">4</span></span>
<span id="cb3-15"><a href="M7-1.html#cb3-15" aria-hidden="true" tabindex="-1"></a>   csv_point_vars <span class="kw">=</span> <span class="st">&#39;temp&#39;</span>,<span class="st">&#39;salt&#39;</span>,<span class="st">&#39;PHS_frp&#39;</span>,<span class="st">&#39;NIT_amm&#39;</span></span>
<span id="cb3-16"><a href="M7-1.html#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="kw">/</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Assess how the degree of stratification changes as the initial water level of the lake is reduced by 20m. To do this change the initial starting lake depth and profile details in <code>glm3.nml</code>.</li>
</ol>

<div class="rmdtip2">
You will need to update the output depth of your surface output file.
</div>

<div class="rmdtip2">
For future activities make sure you change back to 43m.
</div>
</div>
<div id="M7_11" class="section level4 unnumbered">
<h4>The Ecosystem Model</h4>
<center>
<p><img src="images/module7/picture1.jpg" width="75%" /></p>
</center>
<p>The <em>Kinneret97</em> model simulation above has the ecological model aed2 enabled. It has been pre- configured to run the customizable <a href="http://aquatic.science.uwa.edu.au/research/models/AED/modules.html">AED modules</a>. These are separate models, but have been set up to run side by side. They are configured using the text file <code>aed2.nml</code>.</p>

<div class="rmdnote2">
<p>The above simulation was only plotting temperature and salinity and these plots were configured in <code>plots.nml</code>. Open <code>plots.nml</code> to see how you can customise the graphs. There are many other variables we may be interested in plotting when we run the watter quality model such as oxygen, nutrients, and algae. A pre-configured file called <code>plots_aed2.nml</code> has been created. To use this file, rename it to <code>plots.nml</code> (you’ll first need to rename the existing <code>plots.nml</code>) and run the model. You should now see more outputs for the lake simulation.</p>
</div>
<p>In <code>plots.nml</code> the required variables are all listed, make sure the number of plots is high enough to include them all.</p>
<center>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:250px; overflow-x: scroll; width:100%; ">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tabM7-1">Table 8: </span>Water quality variables and their descriptions.
</caption>
<thead>
<tr>
<th style="text-align:center;">
Description
</th>
<th style="text-align:center;">
Variable Name
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;min-width: 25em; ">
Passive tracer
</td>
<td style="text-align:center;min-width: 25em; ">
<code>TRC_tr1</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Water age
</td>
<td style="text-align:center;min-width: 25em; ">
<code>TRC_age</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Suspended solids
</td>
<td style="text-align:center;min-width: 25em; ">
<code>NCS_ss1</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved oxygen
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OXY_oxy</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved inorganic carbon
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_dic</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
pH
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_pH</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Methane (dissolved)
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_ch4</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Methane (bubbles)
</td>
<td style="text-align:center;min-width: 25em; ">
<code>CAR_ch4_bub</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Reactive Silica
</td>
<td style="text-align:center;min-width: 25em; ">
<code>SIL_rsi</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Ammonium
</td>
<td style="text-align:center;min-width: 25em; ">
<code>NIT_amm</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Nitrate/Nitrite
</td>
<td style="text-align:center;min-width: 25em; ">
<code>NIT_nit</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Phosphate
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHS_frp</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particulate inorganic phosphorus
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHS_frp_ads</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic carbon
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_doc</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particualte organic carbon
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_poc</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic nitrogen
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_don</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particulate organic nitrogen
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_pon</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Dissolved organic phosphorus
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_dop</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Particulate organic phsophorus
</td>
<td style="text-align:center;min-width: 25em; ">
<code>OGM_pop</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Green algae
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_green</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Green algae
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_green_IN</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Green algae
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_green_IP</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Diatoms
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_diatom</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Diatoms
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_diatom_IN</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Diatoms
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_diatom_IP</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Cyrptophytes
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_crypto</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Cyrptophytes
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_crypto_IN</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Cyrptophytes
</td>
<td style="text-align:center;min-width: 25em; ">
<code>PHY_crypto_IP</code>
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 25em; ">
Zooplankton
</td>
<td style="text-align:center;min-width: 25em; ">
<code>ZOO_zoo01</code>
</td>
</tr>
</tbody>
</table>
</div>
</center>
<p><br></p>
<p>Let’s also now add water quality variables to the specific depth output files (i.e. <code>WQ_5.csv</code>). To do so we must edit the output section of the <code>glm3.nml</code> file, by adding the variables as extra columns to the <code>.csv</code> file that were configured above.</p>

<div class="rmdtip2">
If they are there already, make sure that the number of variables is high enough to include them all.
</div>
<style>
ol > li > ol > li {list-style-type:lower-alpha}
</style>
<ol start="7">
<li>
<ol>
<li>
<p>As an example to output water quality variables, let’s plot all the nitrogen variables. Change <code>csv_point_vars</code> to include <code>NIT_amm</code>, <code>NIT_nit</code>, <code>OGM_don</code>, <code>OGM_pon</code>, <code>PHY_green_IN</code> - these are all the variables that contribute to the total nitrogen (TN) pool. Now re-run the model (e.g. Windows users double clicking <code>glm.bat</code> again). Once it’s run open <code>WQ_35.csv</code> to see these new variables and create a stacked area plot to show how the different variables contribute to TN.</p>
</li>
<li>
<p>Create a well formatted, interesting graph of variables of your choice (for example, you may like to consider all of the phytoplankton groups or create sums of these to generate a NPZD model) to see how they interact and change over time. If any variables are much bigger or smaller than the others, then use two y-axes or multiple plots.</p>
</li>
</ol>
</li>
</ol>
<ol start="8" style="list-style-type: decimal">
<li>How would these concentrations change if the air temperature increased by 2°C? (You will need to edit the <code>met_hourly.csv</code> file). Make sure to save with correct date format, taking note these met measurements are recorded hourly, so YYYY-MM-DD hh:mm. A pre-made version of this file can be found in <em>bcs</em> which is called <code>met_1997_2004_airT2.csv</code>. To use this file, update <code>meteo_fl = 'bcs/met_1997_2004.csv'</code> in the <code>&amp;meteorology</code> section of <code>glm3.nml</code>.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id="cb4-1"><a href="M7-1.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb4-2"><a href="M7-1.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">! meteorology</span></span>
<span id="cb4-3"><a href="M7-1.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">!-------------------------------------------------------------------------------</span></span>
<span id="cb4-4"><a href="M7-1.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&amp;</span>meteorology</span>
<span id="cb4-5"><a href="M7-1.html#cb4-5" aria-hidden="true" tabindex="-1"></a>   met_sw      <span class="kw">=</span> <span class="cn">.true.</span></span>
<span id="cb4-6"><a href="M7-1.html#cb4-6" aria-hidden="true" tabindex="-1"></a>   lw_type     <span class="kw">=</span> <span class="st">&#39;LW_IN&#39;</span></span>
<span id="cb4-7"><a href="M7-1.html#cb4-7" aria-hidden="true" tabindex="-1"></a>   rain_sw     <span class="kw">=</span> <span class="cn">.false.</span></span>
<span id="cb4-8"><a href="M7-1.html#cb4-8" aria-hidden="true" tabindex="-1"></a>   atm_stab    <span class="kw">=</span> <span class="dv">0</span></span>
<span id="cb4-9"><a href="M7-1.html#cb4-9" aria-hidden="true" tabindex="-1"></a>   fetch_mode  <span class="kw">=</span> <span class="dv">0</span></span>
<span id="cb4-10"><a href="M7-1.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">!rad_mode    = 1</span></span>
<span id="cb4-11"><a href="M7-1.html#cb4-11" aria-hidden="true" tabindex="-1"></a>   albedo_mode <span class="kw">=</span> <span class="dv">1</span></span>
<span id="cb4-12"><a href="M7-1.html#cb4-12" aria-hidden="true" tabindex="-1"></a>   cloud_mode  <span class="kw">=</span> <span class="dv">4</span></span>
<span id="cb4-13"><a href="M7-1.html#cb4-13" aria-hidden="true" tabindex="-1"></a>   <span class="co">!-- BC file details</span></span>
<span id="cb4-14"><a href="M7-1.html#cb4-14" aria-hidden="true" tabindex="-1"></a>   subdaily    <span class="kw">=</span> <span class="cn">.true.</span></span>
<span id="cb4-15"><a href="M7-1.html#cb4-15" aria-hidden="true" tabindex="-1"></a>   meteo_fl    <span class="kw">=</span> <span class="st">&#39;bcs/met_1997_2004.csv&#39;</span> <span class="co">!UPDATE THIS</span></span>
<span id="cb4-16"><a href="M7-1.html#cb4-16" aria-hidden="true" tabindex="-1"></a>   wind_factor <span class="kw">=</span> <span class="fl">0.9</span></span>
<span id="cb4-17"><a href="M7-1.html#cb4-17" aria-hidden="true" tabindex="-1"></a>   lw_factor   <span class="kw">=</span> <span class="fl">1.0</span></span>
<span id="cb4-18"><a href="M7-1.html#cb4-18" aria-hidden="true" tabindex="-1"></a>   lw_offset   <span class="kw">=</span> <span class="fl">0.0</span></span>
<span id="cb4-19"><a href="M7-1.html#cb4-19" aria-hidden="true" tabindex="-1"></a>   <span class="co">!-- Parameters</span></span>
<span id="cb4-20"><a href="M7-1.html#cb4-20" aria-hidden="true" tabindex="-1"></a>   ce <span class="kw">=</span> <span class="fl">0.0013</span></span>
<span id="cb4-21"><a href="M7-1.html#cb4-21" aria-hidden="true" tabindex="-1"></a>   ch <span class="kw">=</span> <span class="fl">0.0013</span></span>
<span id="cb4-22"><a href="M7-1.html#cb4-22" aria-hidden="true" tabindex="-1"></a>   cd  <span class="kw">=</span> <span class="fl">0.0013</span></span>
<span id="cb4-23"><a href="M7-1.html#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">!catchrain      = .true.</span></span>
<span id="cb4-24"><a href="M7-1.html#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">!rain_threshold = 0.001</span></span>
<span id="cb4-25"><a href="M7-1.html#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">!runoff_coef    = 0.0</span></span>
<span id="cb4-26"><a href="M7-1.html#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="kw">/</span></span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>What happens if we change the water clarity? Increase and decrease from the original value to see the response</li>
</ol>

<div class="rmdtip2">
You must change the light extinction coefficient <code>Kw</code> (range 0-1) in the <code>glm3.nml</code> file.
</div>
</div>
<div id="M7_12" class="section level4 unnumbered">
<h4>Assessing Error &amp; Sensitivity</h4>
<ol start="10" style="list-style-type: decimal">
<li>Calculate the mean absolute error in the simulation using the observed temperature data (<code>ObservedTempData.xlsx</code> from the <em>data</em> folder in <em>Kinneret97</em>) and the simulated temperature data (the simulated temperature data is from the surface layer in <code>lake.csv</code>).</li>
</ol>
<center>
<span class="math display" id="eq:module7-1">\[\begin{equation}
MAE = \frac{\sum_{i}\left | T_{i}^{sim}-T_{i}^{obs} \right |}{n}
\tag{56}
\end{equation}\]</span>
</center>
<style>
ol > li > ol > li {list-style-type:lower-alpha}
</style>
<ol start="11">
<li>
<ol>
<li>
<p>Calculate the sensitivity of the modelled temperature to changes in water clarity (the light extinction coefficient, <span class="math inline">\(K_w\)</span>) and wind speed (<code>wind_factor</code>). These can be found in <code>glm3.nml</code>. Try increasing and decreasing the default parameter value by 0.2 and see how much the output changes.</p>
</li>
<center>
<span class="math display" id="eq:module7-2">\[\begin{equation}
SI = \frac{(Output_{new}-Output_{original})/Output_{original}}{(Parameter_{new}-Parameter_{original})/Parameter_{original}}
\tag{57}
\end{equation}\]</span>
</center>
<li>
<p>Assess how sensitive the temperature and phytoplankton biomass is to water clarity:</p>
</li>
<p><br></p>
<center>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
GLM results
</th>
<th style="text-align:center;">
Water clarity Decrease 0.37
</th>
<th style="text-align:center;">
Water clarity Original 0.57
</th>
<th style="text-align:center;">
Water clarity Increase 0.77
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;min-width: 10em; ">
Average WQ_35 temperature
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 10em; ">
Average WQ_35 phytoplankton (green, crypto, diatom) biomass
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
</tr>
</tbody>
</table>
</div>
</center>
<p><br></p>
<li>
<p>Assess how sensitive the temperature and phytoplankton biomass is to wind speed:</p>
</li>
<p><br></p>
<center>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
GLM results
</th>
<th style="text-align:center;">
Wind Speed Decrease 0.6
</th>
<th style="text-align:center;">
Wind Speed Original 0.9
</th>
<th style="text-align:center;">
Wind Speed Increase 1.2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;min-width: 10em; ">
Average WQ_35 temperature
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
</tr>
<tr>
<td style="text-align:center;min-width: 10em; ">
Average WQ_35 phytoplankton (green, crypto, diatom) biomass
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
<td style="text-align:center;min-width: 10em; ">
</td>
</tr>
</tbody>
</table>
</div>
</center>
</ol>
</li>
</ol>
</div>
</div>
<div id="M7_13" class="section level3 unnumbered">
<h3>Submission</h3>
<div class="redbox2">
<p><strong>Submit properly formatted graphs and tables of the following sections of the lab:</strong></p>
<p>Lake Stratification:</p>
<ul>
<li>Hand drawn diagram of the lake and any variables you used</li>
<li>Plots of the water balance</li>
<li>Plots of the heat fluxes</li>
<li>Plots of the temperature at different layers</li>
<li>Plots of the shallower lake</li>
</ul>
<p>The Ecosystem Model:</p>
<ul>
<li>Hand drawn diagram of the lake with any variables you used</li>
<li>Interesting plot of the selected variables</li>
<li>Any results of the higher air temperature and changed water clarity</li>
</ul>
<p>Assessing Error &amp; Sensitivity:</p>
<ul>
<li>Temperature error assessment</li>
<li>Temperature and phytoplankton sensitivity assessment</li>
<li>Tables for submission</li>
</ul>
<p>These are to be uploaded in a word doc or PDF format. No screenshots of figures from Excel/Excel spreadsheets to be uploaded</p>
<p><strong>General professional formatting guidelines:</strong></p>
<ul>
<li>All figures are to have adequate captions explaining them</li>
<li>For graphs, figure captions go below the plot</li>
<li>For tables, the caption goes above the table</li>
<li>Make sure figures and their text size is readable</li>
</ul>
<p><strong>Excel hints:</strong></p>
<ul>
<li>When there is a caption for a plot, you remove the title</li>
<li>Remove the plot border and gridlines</li>
<li>Make sure both axes have visible lines and tick marks</li>
<li>Units need to be noted properly with the axis label - ‘Temperature (°C)’</li>
<li>Round numbers to be reasonable</li>
</ul>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="M6-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["Module 1 Resources.zip", "Module 1 Resources"], ["Module 2 Resources.zip", "Module 2 Resources"], ["Module 4 Resources.zip", "Module 4 Resources"], ["Module 5 Resources.zip", "Module 5a&b Resources"], ["Module 6 Resources.zip", "Module 6 Resources"], ["Module 7 Resources.zip", "Module 7 Resources"]],
"toc": {
"collapse": "section"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
