[
["index.html", "Environmental Dynamics Workbook Introduction", " Environmental Dynamics Workbook Giles Knight 2020-06-23 Introduction Welcome to the Environmental Dynamics Workbook! "],
["getting-started.html", "Getting Started Tools You’ll Need", " Getting Started Tools You’ll Need Excel Using functions Functions in Excel always begin with an = sign. R To get started with R, first download the base R system onto your computer. By itself, this provides a rudimentary console for interacting with the R programming language. For a more user-friendly experience, download the R Studio integrated development environment (IDE). R can be downloaded here R Studio can be downloaded here Terminology File types In this unit you will largely be dealing with two kinds of ‘R files’: R script files (e.g. Equations.R) and, R project files (e.g. Module2Biogeochem.Rproj) R scripts are the raw instructions that tell the R programming language what to do. While an R Project file simply creates an independent workplace environment for you to interact with and manage your scripts. It’s wise to create a new R Project file whenever you start working on a new project. Functions and packages Just like Excel, you can interact with your data using a variety of functions in R. Functions are the tools you use to get the job done. For example, the plot() function can be used to create graphs. R is an open source programming language, meaning anyone can create their own functions and bundle them up in a collection known as a package. Comments All programming languages allow the user to write comments on their code to assist in readability and structure. In R, a comment is defined as a line beginning with a #. Any characters written after the # are ignored by R and not executed. It’s good practice to get into the habit of commenting your R code as it will likely save you (or someone else!) a lot of time later down the track. # This is a comment! # Create a graph using the plot() function plot(my_data,variable1,col=&quot;red&quot;,ylab=&quot;My y-axis label&quot;) # Plot other variables onto the graph using the points() function points(my_data,variable2,col=&quot;blue&quot;) points(my_data,variable3,col=&quot;green&quot;) points(my_data,variable4,col=&quot;purple&quot;) To comment multiple lines of code at once in R Studio, pressCommand + Shift + Con MacOS orControl + Shift + Con Windows Further R resources Read the Introduction to R and Statistics book for a more detailed coverage on the core data visualisation and statistics capabilities in R Access UWA’s LinkedIn Learning portal the learn more about the basics of R Refer to some handy R cheatsheets R Studio cheatsheet ggplot2 data visualisation cheatsheet Unzipping files Many of the module resources found in this workbook are downloaded as ‘zipped’ (i.e. compressed) files. ‘Unzipping’ (i.e. extracting) these files is simple. On MacOS, simply double click the ‘zipped’ file: On Windows, click ‘Extract All’ and follow the prompt: "],
["module-1-modelling-in-excel.html", "Module 1: Modelling in Excel Environmental Flows to an Estuary", " Module 1: Modelling in Excel Environmental Flows to an Estuary Objectives Become familiar with basic spreadsheet commands in Excel by conducting an environmental flow analysis and building a simple impact model. What is an environmental flow? Lakes, rivers and estuaries are adapted to receive water based on the natural hydrological condition, but often water is required upstream for other purposes. An environmental flow is water that is provided to the environment to maintain its health and natural diversity Case study Figure 1: Drain L inflows (yellow arrow) will be diverted (blue arrow) Module resources Download the Excel spreadsheet: MODULE01_EnvFlowData.xls Exercises You are given a time-series of daily river flow and need to assess how different diversion scenarios impact the freshwater flow delivery to a down stream estuary. For this flow time-series, calculate the volume of daily flow within the following bands 0-40; 40-80; 80-120; 120-200; 200-400; 400-1000; &gt;1000 Use Nested “IF” statement in adjacent columns to partition flows For this flow time-series, calculate the number of days daily flow within the above bands and work out annual average number of days Use COUNT() to get the number of entries in the column Calculate the annual amount of flow in total and in each band You may do the annual averaging manually or the pivot table method. For the pivot table method: Insert a new column B, Label it Year. Type the year number into the first cell, make sure it is formatted as a number. Use YEAR() to speed this step up Click two times on the little square in the corner of the box. This will fill down the page. Repeat this at each year change and you will have the year only information which you can then use to summarise data. As the original date has day numbers and decimal time each one is unique so you end up with a record for each day. This way you get a record for each year. Highlight all the data. It must have headings for each column or it won’t work. Go to “Insert” then “Pivot Table”. Click OK as you want the default settings. Then you just fiddle until you get what you want. The following is an example: Sort the years from highest to lowest flow: Add a new column next to the flows indexing the years sequentially (i.e. 1, 2, 3…) Add a new column next to the indices calculating the probability of meeting the annual flow: \\(P(Yri) = \\frac{i}{\\text{number of years}+1}\\) Scatter plot the flow vs probability curve. Sum each year Assess the amount of water available for flow diversion for two scenarios by adding a new time-series column for each option: Water below 50 ML/day and above 550 ML/day is NOT diverted Water below 150 ML/day and above 1000 ML/day is NOT diverted Add two new columns for each of the above to work out cumulative amount of diverted water \\(X^{+1} = X +dX\\) Create a scatter plot of historical salinity (as EC) collected from the site marked in the map (+) vs daily discharge from the drain (see sheet: Estuary – Salinity). Fit a trendline to the data and display equation and R2 – this is a statistical model. In a new time-series column in the previous sheet, use the statistical model from above to predict a salinity time-series for the above station in the estuary under the two diversion scenarios compared to the base case. Submission Submit properly formatted graphs and tables of the following sections of the lab: Q2: Table of the number of days daily flow within the above bands and annual average number of days Q3: Table of the annual amount of flow in total and in each band Q4: Table of annual flow by year with index and probability. Scatter plot of the flow vs probability curve Q6: Table of the cumulative amount of diverted water Q7 &amp; 8: Scatterplot of the EC vs. daily discharge from the drain, with trendline, equation and R2 value Q9: Plot of the salinity timeseries of the two diversion scenarios compared to the base case In less than 100 words, discuss which is the most appropriate scenario choice for management of the estuary These are in a word doc or PDF format. No screenshots of figures from Excel/Excel spreadsheets to be uploaded General professional formatting guidelines: All figures are to have adequate captions explaining them For graphs, figure captions go below the plot For tables, the caption goes above the table Make sure figures and their text size is readable Excel hints: When there is a caption for a plot, you remove the title Remove the plot border and gridlines Make sure both axes have visible lines and tick marks Units need to be noted properly with the axis label - ‘Temperature (°C)’ Round numbers to be reasonable "],
["module-2-biogeochemistry.html", "Module 2: Biogeochemistry Bacterially Mediated Organic Matter Oxidation Rates", " Module 2: Biogeochemistry Bacterially Mediated Organic Matter Oxidation Rates Objectives Become familiar with basic spread sheet commands in excel by building a simple biogeochemical model from chemical and mathematical equations. Become familiar with the program R Studio and compare it to Excel. Modelling concepts This model has variables of concentration and rate, no spatial dimensions, and it has a dimension of time. Last week’s model had variables of volume and concentration (salinity), and was also resolved in time. In coming weeks the models will be resolved in zero, one, two or three dimensions of space, and only some will be resolved in time. Going down the rows of the Excel spread sheet means going forward in time, as the differential equations break the time axis into hundreds of tiny little chunks. The concentration at any point in time may depend on concentration at the previous point in time. We use the notation concentrationt depends on concentrationt-1. Organic matter oxidation Organic matter (dead algae, leaves etc.) is oxidised by different bacteria that use a range of oxidants. The bacteria simultaneously consume organic matter and an oxidant, in a similar way to how humans consume carbohydrate and oxygen. Scientists have observed that there is a general sequence of oxidants used, based on the energy available for each process. When all of the oxidants are consumed, methanogenesis takes place, where bacteria use the organic matter alone without any oxidant. This is similar to the lactic acid metabolic system that the human body uses when oxygen is in short supply, such as when you go for a run. Remember that methane is a reduced byproduct, not an oxidant. Other reduced by-products include N2 gas, Mn2+ and Fe2+ metal ions, and the S2- anion. We can construct a model to determine the rates at which the oxidation takes place, and use the rates to determine other processes such as oxygen consumption, denitrification or phosphate adsorption. The rate is dependent on the concentration of the organic matter, \\(\\color{#E36C0A}{OM}\\), and a rate constant, \\(\\color{#00B0F0}{k_{OM}}\\). The rate is not dependent on the concentration of the oxidant, until the oxidant concentration becomes very low: this process is included as a \\(\\color{#76923C}{\\text{limitation}}\\) term (With more O2 you do not become super; with less O2 you get sleepy). A \\(\\color{#76923C}{\\text{Monod}}\\) equation is used to limit the rate. \\[\\begin{equation} R_{O_{2}} = \\color{#00B0F0}{K_{OM}}\\color{#E36C0A}{OM}\\color{#76923C}{\\frac{O_{2}}{O_{2}+K_{O_{2}}}} \\tag{1} \\end{equation}\\] The generally observed sequence of oxidants is modelled with an \\(\\color{#FF0000}{\\text{inhibition}}\\) process, so that a higher energy yielding oxidant, such as oxygen, inhibits a lower energy oxidant such as iron. \\[\\begin{align*} R_{NO_{3}} &amp;= \\color{#00B0F0}{k_{OM}}\\color{#E36C0A}{OM}\\color{#76923C}{\\frac{NO_{3}}{NO_{3}+K_{NO_{3}}}}\\color{#FF0000}{\\frac{K_{O_{2}}}{O_{2}+K_{O_{2}}}}\\\\ \\tag{2}\\\\ R_{Mn} &amp;= \\color{#00B0F0}{k_{OM}}\\color{#E36C0A}{OM}\\color{#76923C}{\\frac{Mn}{Mn+K_{Mn}}}\\color{#FF0000}{\\frac{K_{NO_{3}}}{NO_{3}+K_{NO_{3}}}}\\color{#FF0000}{\\frac{K_{O_{2}}}{O_{2}+K_{O_{2}}}}\\\\ \\tag{3}\\\\ R_{Fe} &amp;= \\color{#00B0F0}{k_{OM}}\\color{#E36C0A}{OM}\\color{#76923C}{\\frac{Fe}{Fe+K_{Fe}}}\\color{#FF0000}{\\frac{K_{Mn}}{Mn+K_{Mn}}}\\color{#FF0000}{\\frac{K_{NO_{3}}}{NO_{3}+K_{NO_{3}}}}\\color{#FF0000}{\\frac{K_{O_{2}}}{O_{2}+K_{O_{2}}}}\\\\ \\tag{4}\\\\ R_{SO_{4}} &amp;= \\color{#00B0F0}{k_{OM}}\\color{#E36C0A}{OM}\\color{#76923C}{\\frac{SO_{4}^{2-}}{SO_{4}^{2-}+K_{SO_{4}}}}\\color{#FF0000}{\\frac{K_{Fe}}{Fe+K_{Fe}}}\\color{#FF0000}{\\frac{K_{Mn}}{Mn+K_{Mn}}}\\color{#FF0000}{\\frac{K_{NO_{3}}}{NO_{3}+K_{NO_{3}}}}\\color{#FF0000}{\\frac{K_{O_{2}}}{O_{2}+K_{O_{2}}}}\\\\ \\tag{5}\\\\ R_{Meth} &amp;= \\color{#00B0F0}{k_{OM}}\\color{#E36C0A}{OM}\\color{#FF0000}{\\frac{K_{SO_{4}}}{SO_{4}^{2-}+K_{SO_{4}}}}\\color{#FF0000}{\\frac{K_{Fe}}{Fe+K_{Fe}}}\\color{#FF0000}{\\frac{K_{Mn}}{Mn+K_{Mn}}}\\color{#FF0000}{\\frac{K_{NO_{3}}}{NO_{3}+K_{NO_{3}}}}\\color{#FF0000}{\\frac{K_{O_{2}}}{O_{2}+K_{O_{2}}}}\\\\ \\tag{6}\\\\ \\end{align*}\\] In this lab, we simulate a blob of aquatic sediment. It is a closed system, so that the initial concentrations react until they reach equilibrium. This system is also perfectly mixed, with an unchanging biomass of bacteria, and so there is no spatial resolution. This allows us to focus on the chemical reactions alone. Module resources Download the Excel spreadsheet: MODULE02_Biogeochemistry.xlsx Download the R scripts: MODULE2_R_Biogeochem.zip Exercises Building the model in Excel Looking at the sequence of equations above: what is the difference between the limitation and the inhibition term? Have a good think about this. If concentration were amazingly bigger or smaller than the \\(K_{O_{x}}\\)1, what would happen to the rates of the higher and lower energy processes? For example, with a high oxygen concentration, what would happen to the manganese reduction rate? With a low oxygen and nitrate concentration, and a high manganese concentration, what would happen to the manganese oxidation rate? Complete the excel spreadsheet for iron reduction, sulfate reduction and methanogenesis. Oxygen, nitrate and manganese are done already, so copy the method and use the equations at the tops of the columns. It is tedious, fiddly and there is a good chance that you will introduce bugs that are hard to find. This is the nature of Excel. Note that the rate is dependent on the concentration in the previous time step – this is called an explicit solution (as opposed to implicit). Complete the line plot (1) of relative oxidant concentration for iron and sulphate. Right click on the plot and use ‘Add data’, make the x axis time and the y axis relative concentration. It is easy to visualise if you keep the colours consistent, and choose the colours that you like. Adjust the values for the initial condition and the half-saturation constants and see how the lines move on your plot. Add more time steps underneath if you want to see what happens over the long term. Complete the area plot (2) of reaction rates, then play around with the numbers to test the sensitivities of the outputs to the parameter inputs Building the model in R Now the excel spreadsheet is working, the next step is to repeat the process in R. Open the R project and the three scripts: there is one in which you set the input parameters and initial conditions; one which has the equations; and one which is used for plotting the outputs. Read through them and become familiar with what is in each. Run each script in sequence, starting with Inputs, then Equations, then Plotting. The plotting script should make a plot appear in the bottom right corner. Enter the inputs, equations and plotting scripts for iron, sulfate and methanogenesis reactions, just as you did in the excel spreadsheet. Remember that you just need a rate of methanogenesis: methane is not an oxidant like sulfate. In the Plotting script, uncomment (remove the #s) the lines starting with png and dev.off. Now if you run the plot (3) again, it saves the plot to a .png file. You can edit the settings of the png line to create a high quality figure to put in the report. Now we have a working process-based model. This was the hard and boring part, but now we can be creative. So far we have established an initial condition and let it run to completion, but next we can model a hypothetical environmental situation. For example, imagine there were an oxygen fluctuation, perhaps from algal photosynthesis occurring in the day but not at night in a lake, or from the tidal movement of hypoxic water. In either Excel or R, create a new environmental situation that involves organic matter oxidation. Consider the assumptions you are making and how important they are. Use the model to test the effect of this situation on concentrations and rates. For example, what would happen if there were regular organic matter deposition as a boundary condition? Or maybe what if there were a constant oxygen concentration? What conditions might be needed to minimise methanogenesis? How could you maximise denitrification? I will give higher marks if you do something original and creative. Write a brief description of your new situation and create one plot (4) to explain your result. Submission Submit properly formatted graphs and tables of the following sections of the lab: Graph of concentration (y) against time (x) scatter plot, for all oxidants, made in Excel Graph of rate (y) against time (x) area plot, for all oxidants Graph of concentration (y) against time (x) scatter plot, for all oxidants, made in R Any figure of a new environmental situation you create, and a brief explanation of lessthan 100 words of how you used the model creatively. These are in a word doc or PDF format. No screenshots of figures from Excel/Excel spreadsheets to be uploaded General professional formatting guidelines: All figures are to have adequate captions explaining them For graphs, figure captions go below the plot For tables, the caption goes above the table Make sure figures and their text size is readable Excel hints: When there is a caption for a plot, you remove the title Remove the plot border and gridlines Make sure both axes have visible lines and tick marks Units need to be noted properly with the axis label - ‘Temperature (°C)’ Round numbers to be reasonable Where \\(K_{O_{x}}\\) is the general term for the half saturation constant of any oxidant, for example \\(K_{O_{2}}\\), \\(K_{SO_{4}}\\) etc.↩︎ "],
["module-3-climate-modeling.html", "Module 3: Climate Modeling Energy Balance Models", " Module 3: Climate Modeling Energy Balance Models Objectives To construct a simple energy balance climate model for the earth in Excel To understand the role of greenhouse gases, and incorporate them into an energy balance climate model Case Study 1: A “Zero-Dimensional” Energy Balance Model Here, we assume that the Earth is a sphere with uniform surface and no differences with latitude and longitude (i.e. everything receives the same amount of solar energy). We also assume that there is a balance, or equilibrium, between incoming short wavelength solar radiation absorbed by the ground and outgoing long wavelength radiation emitted by the ground. To simplify the model further, we assume the Earth emits outgoing (longwave) radiation like a “blackbody”, i.e. it is a perfectly efficient radiator - it gives off the maximum amount of radiation that an object of its temperature can emit. Outgoing Radiation The rate of the outgoing radiant energy (Joules per second = Watts) from a blackbody is given by the Stefan-Boltzmann equation: \\[\\begin{equation} E = \\sigma T^{4} \\tag{7} \\end{equation}\\] \\(\\sigma\\): Stefan-Boltzmann constant (5.67x10-8) \\(T\\): Temperature (in degrees Kelvin) However, for the Earth, this is being emitted over the full surface area of the Earth: \\[\\begin{equation} E_{\\text{out}} = \\sigma 4\\pi r^{2} T^{4} \\tag{8} \\end{equation}\\] \\(r\\): Radius of the Earth (in m) Incoming Radiation The energy absorbed by the earth is given by the amount of incoming solar radiation which is not reflected due to albedo. However, we have to take into account that solar energy is striking the Earth as a parallel beam of circular cross-section. So this incoming beam of radiation hits only a single “disc” of the Earth’s surface at any one time. This area has a surface area \\(\\pi r^{2}\\). \\[\\begin{equation} E_{\\text{abs}} = S\\pi r^{2} (1-a) \\tag{9} \\end{equation}\\] \\(S\\): Incoming solar radiation: the “solar constant” (1367 W/m2) Exercises Using the concept of an energy balance (i.e. energy in = energy out), rearrange the equations to find the Earth’s temperature, \\(T\\). In Excel, construct a simple spreadsheet and fill in the blank cells to calculate the mean temperature of the Earth using the equation from Q1., assuming an albedo of 0.33 (including in °C and °F): Parameter Value Units Solar constant 1367 W/m2 Albedo 0.33 NA Stefan-Boltzmann constant 5.67E-08 NA Mean temperature of Earth ? K Mean temperature of Earth ? °C Mean temperature of Earth ? °F Remember: \\(K = °C + 273.2\\) and \\(°F = 1.8°C + 32\\) a) The current mean temperature of the Earth is 288K (15°C). Does this simple model over or under predict the Earth’s temperature? What important factor is missing from this model? 3) Test the sensitivity of this model to the choice of albedo. Using values from 0.3 to 0.7, calculate and plot T (°C) Albedo Solar constant Assumed Albedo Stefan-Boltzmann constant T (Celsius) 0.3 1367 0.33 5.67e-08 ? 0.4 1367 0.33 5.67e-08 ? 0.5 1367 0.33 5.67e-08 ? 0.6 1367 0.33 5.67e-08 ? 0.7 1367 0.33 5.67e-08 ? Case Study 2: A “quick fix” To try to reduce the error in the model estimates of Earth’s temperature, we can “parameterise” the model using observed or experimentally derived relationships between outgoing radiation and temperature. One such example is: \\[\\begin{equation} E_{\\text{out}} = x + yT \\tag{10} \\end{equation}\\] \\(x = 204\\) W/m2 \\(y = 2.17\\) W/m2/°C This gets inputted into the energy balance equation (energy in = energy out) to give: \\[\\begin{equation} \\pi r^{2} S (1-a) = 4\\pi r^{2}(X+yT) \\tag{10} \\end{equation}\\] Exercises Solve the above equation for \\(T\\) (note, this time, \\(T\\) is in CELSIUS!) Set up a spreadsheet to estimate T for a range of albedo values. Different amounts of glacial ice cover on the Earth could produce albedos from 0.3 for minimal ice to 0.7 for a complete ice cover (this might seem unrealistic, but geologists have recently found evidence to suggest that the Earth was completely ice-covered during Neoproterozoic time 700 million years ago – a “snowball Earth”!) Albedo x y T (Celsius) 0.3 204 2.17 ? 0.4 204 2.17 ? 0.5 204 2.17 ? 0.6 204 2.17 ? 0.7 204 2.17 ? a) Are your results reasonably close for the present-day Earth mean temperature? What is the sensitivity of this model to small changes in albedo? b) Expanding a bit from your model (you might need to consider smaller steps in albedo), at what value of albedo do you think thissimplified Earth would experience strong positive feedback involving ice cover, albedo, and mean temperature, and therefore move rapidly toward “snowball Earth” with albedo = 0.7? Could it ever be deglaciated? Case Study 3: Incorporating Greenhouse Gases This model is a modification of the one described by Harte (1988). He showed that it is appropriate, based on the physics of radiation (as water is the major absolver of terrestrial radiation), to divide the Earth’s atmosphere into a lower layer (from the surface to 1.8km altitude, containing 20% of the air and 50% of the water vapour) and an upper layer (containing 80% of the air and 50% of the water vapour). This time we require three energy-balance equations: For the Earth-atmosphere system as a whole; For the upper layer of the atmosphere; For the lower layer of the atmosphere. In this model, all energy terms are expressed as long-term average fluxes, all temperatures are absolute. We assume that emissivity =1 except at the surface, and (most importantly) that each of the three systems is in equilibrium. Table 1: Energy balance model of Earth’s atmosphere Parameter Description Value \\(S_{\\text{av}}\\) Solar radiation intercepted by Earth (\\(=\\frac{S}{4}\\) where \\(S\\) is the solar constant of 1370Wm-2) 342.5 Wm-2 \\(W\\) Heat generated from nonrenewable energy sources (fossil fuels + nuclear) 0.021 Wm-2 \\(L\\) Average latent heat flux from the surface 80 Wm-2 \\(H\\) Average sensible heat flux at the surface 17 Wm-2 \\(\\sigma\\) Stefan-Boltzmann constant 5.67 x10-8 Wm-2 deg-4 \\(a_{p}\\) Planetary albedo 0.3 \\(k_{u}\\) Fraction of solar radiation absorbed in upper layer of atmosphere 0.18 \\(k_{l}\\) Fraction of solar radiation absorbed in upper lower of atmosphere 0.075 \\(\\varepsilon\\) Emissivity (\\(= 1 - \\text{reflectivity}\\)): the fraction of the infrared radiation emitted by the surface that is absorbed in the atmosphere and then re-emitted 0.95 \\(F_{u}\\) Infrared flux from upper layer (use black-body equation) \\(\\varepsilon \\sigma T_{u}^{4}\\) \\(F_{l}\\) Infrared flux from lower layer (use black-body equation) \\(\\varepsilon \\sigma T_{l}^{4}\\) \\(F_{s}\\) Infrared flux from surface (use black-body equation) \\(\\varepsilon \\sigma T_{s}^{4}\\) Exercise 1 Using the chart above, draw the model yourself by hand, incorporating all fluxes. We can now formulate the three energy-balance equations needed: Energy-balance for the Earth-atmosphere system as a whole: Energy enters the Earth–atmosphere system from above at the rate \\(S\\) and from below at the rate \\(W\\) (heat generated from nonrenewable energy sources: nuclear and fossil fuels). Energy leaves these the system by three routes: Reflected solar radiation: \\(a_{p}S\\); Thermal radiation from the top of the atmosphere: \\(\\sigma T_{u}^{4}\\); and The portion of thermal radiation from the surface that is not absorbed in the atmosphere: \\((1 − \\varepsilon)\\sigma T_{s}^{4}\\). Here: \\(\\varepsilon\\) is the fraction of surface radiation absorbed in the atmosphere (emissivity), \\(\\sigma\\) is the Stefan-Boltzmann constant, and \\(T_{u}\\) is the surface temperature (absolute). Thus, the energy balance for the whole system is: \\[\\begin{equation} S + W = a_{p}S + \\sigma T_{u}^{4} (1 − \\varepsilon)\\sigma T_{s}^{4} \\tag{11} \\end{equation}\\] Energy-balance for the upper layer of the atmosphere: The upper atmospheric layer absorbs a fraction, \\(k_{u}\\), of the solar radiation that strikes it and also receives: Energy radiated upward from the lower layer: \\(\\sigma T_{l}^{4}\\), and One-half of the latent heat that accompanies evaporation from the surface (because this layer holds one-half the atmospheric water vapour): \\(0.5L\\). The upper layer loses energy by thermal radiation upward to outer space and downward to the lower layer. Thus, the energy balance for the upper layer is: \\[\\begin{equation} k_{u} + \\sigma T_{l}^{4} + 0.5L = 2\\sigma T_{u}^{4} \\tag{12} \\end{equation}\\] Energy-balance for the lower layer of the atmosphere: Energy enters the lower atmospheric layer from above as absorption of a fraction, \\(k_{l}\\), of the solar radiation that enters it and as thermal radiation from the upper layer: \\(\\sigma T_{u}^{4}\\). From below, energy enters from: The absorbed portion of thermal radiation from the surface: \\(\\varepsilon \\sigma T_{s}^{4}\\); one-half the latent-heat flux from the surface: \\(0.5L\\); The sensible-heat flux from the surface, \\(H\\); and The anthropogenic heat flux: \\(W\\) . Energy is lost from this layer by upward and downward radiation. The energy balance for the lower layer is therefore: \\[\\begin{equation} k_{l}S + \\sigma T_{u}^{4} + \\varepsilon \\sigma T_{s}^{4} + 0.5L + H + W = 2\\sigma T_{l}^{4} \\tag{13} \\end{equation}\\] Exercise 2 Solve these equations to find a formula for surface temperature \\(T_{s}\\): Equations (11) to (13) are a system of three equations in three unknowns: the temperatures \\(T_{l}\\), \\(T_{u}\\), and \\(T_{s}\\). The other quantities are parameters whose values must be given. The values of temperatures can be found via the following steps: Solve Equation (11) for \\(T_{u}\\) in terms of \\(T_{s}\\) and parameters. Solve Equation (12) for \\(T_{l}\\) in terms of \\(T_{u}\\) and parameters. Substitute the results of step 1 into the results of step 2 to give an equation for \\(T_{l}\\) in terms of \\(T_{s}\\) and parameters. Solve Equation (13) for \\(T_{s}\\) in terms \\(T_{l}\\), \\(T_{u}\\), and parameters. Put the results of steps 1 and 3 into the results of step 4 and simplify to give the equation for \\(T_{s}\\) as a function of parameters: \\[\\begin{equation} T_{s} = [\\frac{(3-3a_{p}-2k_{u}-k_{l})S-1.5L-H+2W}{(3-2\\varepsilon)\\sigma}]^{\\frac{1}{4}} \\tag{14} \\end{equation}\\] Show your workings! Using the values given in Table 1, what value do you derive for \\(T_{s}\\)? How close is this to the actual value of 290K? Exercise 3 Using Excel, test the sensitivity of this model to albedo. Compare your findings to those found in part 1 (A plot of \\(T_{s}\\) for values of albedo between 0.3 and 0.7 might help here). Submission Submit properly formatted graphs and tables of the following sections of the lab: Clear photograph or page scan of your hand drawn conceptual model of the Harte 1-D Energy Balance Model, including key explaining the terms. Clear photograph or page scan of your handwritten workings of the Harte Model calculations, with a clear answer of \\(T_{s}\\), the Earth’s temperature. Summary plot from Exercise 1, 2 &amp; 3 assessing albedo and temperature of the three models, with a brief explanation of less than 150 words of which model you prefer. The submission is to be all together in a word doc or PDF format. No screenshots of figures from Excel/Excel spreadsheets to be uploaded. General professional formatting guidelines: All figures are to have adequate captions explaining them For graphs, figure captions go below the plot For tables, the caption goes above the table Make sure figures and their text size is readable Excel hints: When there is a caption for a plot, you remove the title Remove the plot border and gridlines Make sure both axes have visible lines and tick marks Units need to be noted properly with the axis label - ‘Temperature (°C)’ Round numbers to be reasonable References "],
["module-4-oceanic-ph-calculation.html", "Module 4: Oceanic pH Calculation", " Module 4: Oceanic pH Calculation Objectives Calculate the carbonate species distribution given pH and CO2 (gas) Build a double-log plot based on a range of pHs Calculate the pH change and CaCO3 solubility given an increased atmospheric CO2. Replot other published data for comparison with our data Overview In this exercise, we create a simple model of the ocean, with a limited number of state variables. We examine the chemical interactions that result from atmospheric CO2 gas dissolving in water, along with calcium salts in the ocean fed by erosion of minerals on the land. The key overall process is that dissolved CO2 and Ca2+ are in equilibrium with solid CaCO3 (limestone). The major variables are given in Table 2. Given any two of the variables on the left hand column, the other four can be calculated. Table 2: Major variables \\(CO_{2 (\\text{gas})}\\) \\(CO_{2 (\\text{dissolved})}\\) \\(H^{+}\\) \\(Ca^{2+}\\) \\(HCO_{3}^{-}\\) \\(OH^{-}\\) \\(CO_{3}^{2-}\\) \\(H_{2}CO_{3}\\) \\(C_{T} \\text{ (total dissolved inorganic carbon)}\\) \\(H_{2}CO_{3}^{*}\\) \\(\\text{Alkalinity}\\) Figure 1: CC BY 3.0, https://en.wikipedia.org/w/index.php?curid=32829631 Exercise 1 In the first exercise, we set pH to be 8.3 and atmospheric CO2 gas to be 3.5×10-4 atmospheres, and calculate the other variables based on these two. CO2 gas dissolves in water according to Equation (15). The dissolved CO2 easily dissociates into carbonic acid according to Equation (16). For simplicity, we will go straight from atmospheric CO2 to H2CO3*, which is the sum of dissolved CO2 and carbonic acid, using Equation (17). \\[\\begin{align*} {CO}_{2\\ \\left(\\text{gas}\\right)}&amp;\\rightleftarrows{CO}_{2\\ \\left(\\text{dissolved}\\right)} \\tag{15} \\\\ {CO}_{2\\ \\left(\\text{dissolved}\\right)}+H_2O&amp;\\rightleftarrows H_2{CO}_3 \\tag{16} \\\\ {CO}_{2\\ \\left(gas\\right)}+H_2O&amp;\\rightleftarrows \\color{#ED7D31}{H_2CO_3^\\ast} \\hspace{3em} K_{H} = 3.39×10^{-2} \\tag{17} \\\\ \\end{align*}\\] The carbonic acid dissociates into a hydrogen ion (H+, or proton) and a bicarbonate ion (HCO3-), according to Equation (18). The bicarbonate further dissociates into carbonate (CO32-) and another hydrogen ion, as shown in Equation (19). The release of these two hydrogen ions is what creates the acidity of the ocean. \\[\\begin{align*} \\color{#ED7D31}{H_2CO_3^\\ast} &amp;\\rightleftarrows \\color{#00B050}{HCO_3^-}+\\color{#FF0000}{H^+} \\hspace{3em} K_{1} = 5×10^{-7} \\tag{18} \\\\ \\color{#00B050}{HCO_3^{-}} &amp;\\rightleftarrows \\color{#5B9BD5}{{CO}_3^{2-}}+\\color{#FF0000}{H^+} \\hspace{3em} K_{2} = 5×10^{-11} \\tag{19} \\\\ \\end{align*}\\] Total carbon, \\(C_{T}\\), is defined as the sum of these carbonate species. Alkalinity is defined as the sum of the charged carbonate species and the balance of hydrogen ions and hydroxide (OH-), as shown in Equations (20) and (21). (Remember that alkalinity is the opposite of acidity.) \\[\\begin{align*} C_T&amp;=\\left[\\color{#00B050}{{HCO}_3^-}\\right]+\\left[\\color{#5B9BD5}{{CO}_3^{2-}}\\right]+\\left[\\color{#ED7D31}{H_2{CO}_3^\\ast}\\right] \\tag{20} \\\\ \\left[Alk\\right]&amp;=\\left[\\color{#00B050}{{HCO}_3^-}\\right]+2\\left[\\color{#5B9BD5}{{CO}_3^{2-}}\\right]+\\left[{OH}^-\\right]-\\left[\\color{#FF0000}{H^+}\\right] \\tag{21} \\\\ \\end{align*}\\] The concentration of hydroxide can be found by rearranging Equation (22) to Equation (23) and using the dissociation constant of water, KW, and the hydrogen ion concentration. \\[\\begin{align*} [OH^{-}][\\color{#FF0000}{H^{+}}] &amp;= K_{W} \\hspace{3em} K_{W} = 1×10^{-14} \\tag{22} \\\\ [OH^{-}]&amp;=\\frac{K_{W}}{[\\color{#FF0000}{H^{+}]}} \\tag{23} \\\\ \\end{align*}\\] Open the Excel spreadsheet or R project and examine the tab or script Initial CO2. The chemical equations and constants are given to you already. The variables that we are forcing to be constant in Excel are coloured grey. Enter the equations for Exercise 1 into the yellow boxes. If we assume that calcium ion concentration does not vary much in this system, we can force it to be 5×10-4 mol L-1. Calcium carbonate (CaCO3) precipitation or dissolution is governed by the ratio () of Ca2+ concentration and CO32- concentration to the solubility constant, \\(K_{sp}\\), according to Equations (24) and (25). If is greater than 1, then precipitation is favourable, and conversely, if is less than 1, dissolution is favourable. \\[\\begin{align*} {CO}_3^{2-} &amp;+{Ca}^{2+}\\rightleftarrows CaCO_3 \\hspace{3em} K_{sp} = 1\\times 10^{-8.4} \\tag{24} \\\\ \\mathrm{\\Omega} &amp;=\\frac{[Ca2+][CO32-]}{[K_{sp\\space CaCO_{3}}]} \\tag{25} \\\\ \\end{align*}\\] Have a good think about this: given these CO2 and pH, did your calculations lead to a system that favours CaCO3 dissolution or precipitation? Exercise 2 In this exercise you will construct a double-logarithmic plot of this system, holding CO2 constant and varying the pH. Go to the second tab in Excel and copy the equations over from the first tab. Or in R, you can run a for loop to calculate the different concentrations for each of the different pHs. Then you will have some of the major variables converted to logarithms. Next you can make an x y scatter plot. If you add the data correctly, you should get a plot that looks like Figure 2. Big questions: how similar is this plot to yours? At what pH do the OH- and H+ lines cross? Format it nicely, add pK1 etc. and upload it to LMS. Figure 2: Double logarithmic plot of the equilibrium composition of seawater in our model (Stumm and Morgan 1996) Exercise 3 This is the cool part. Here we are going to calculate a new pH given an increased atmospheric CO2 concentration. Given that we calculated the concentrations of all the other species according to the initial distribution in Exercise 1, we now hold them all constant, while increasing CO2 and calculating H+ (and therefore pH). This is not simple, because H+ concentration is tightly bound up with the concentrations of all other species, and so we cannot simply work backwards from any one equation alone. However, there is a quadratic equation (26) that we can solve for \\(H^{+}\\) , using a fixed \\(C_{T}\\), rearranged to Equation (27). \\[\\begin{align*} {\\left[\\color{#FF0000}{H^+}\\right]^2C}_T &amp;=\\color{#ED7D31}{H_2{CO}_3^\\ast}\\left(\\left[\\color{#FF0000}{H^+}\\right]^2+K_1\\left[\\color{#FF0000}{H^+}\\right]+K_1K_2\\right) \\tag{26} \\\\ \\left[\\color{#FF0000}{H^+}\\right] &amp;=\\sqrt[2]{\\frac{\\color{#ED7D31}{H_2{CO}_3^\\ast}}{C_T}\\left(\\left[\\color{#FF0000}{H^+}\\right]^2+K_1\\left[\\color{#FF0000}{H^+}\\right]+K_1K_2\\right)} \\tag{27} \\\\ \\end{align*}\\] Solving this quadratic would be fiendishly difficult. Instead, we will use trial and error, otherwise known as our iterative solution. We will do this to find a value for H+ that is the same on both sides of the equation. Go to the third tab and copy over all of the equations from Exercise 1. The grey boxes are the values that we will hold constant, and the first guess for H+, based on the H+ in Exercise 1. You can alter the CO2 concentration using the CO2 multiplier cell and your rapidly developing Excel and R skills. If you want to double CO2 concentration, type 2 into the multiplier cell. If you want to keep it at present levels, type 1. Repeat the calculation of Equation (13) over successive iterations, using the answer from the previous iteration as your guess for the next iteration. Eventually, the difference between your guesses will become very small and you can settle on a constant pH. (This is roughly how equilibrium-solving computer programs solve complex biogeochemical interactions, often with many more interacting variables than this.) Don’t forget that your successive iterations, are not time steps, like we had in previous weeks. Rather, they are just guesses at the right number that only exist in the model. Your final answer is the only one that has a real scientific meaning. If you want to determine the pH over a range of CO2 concentrations, you will need to repeat the calculation over ~10 rows, and save your results each time. Big questions: if you increase CO2, does the pH rise or fall? Does CaCO3 precipitation become more or less favourable if CO2 increases? Exercise 4 Last exercise. In this exercise, we will take someone else’s data from a plot and make our own plot. Go to the IPCC website and read about CO2 predictions and CaCO3 precipitation. Save their Figure 10.24 as an image file. Go to the Plot Digitizer website and download the program. Open the IPCC image in Plot Digitizer. The program guides you through the steps you need to take: read the command at the bottom of the screen (for example, “Choose most negative end of X axis”) and click “Done” when you have finished (Figure 2A). It will be easiest if you make a point every 10 years. Save each dataset as a separate csv file and then combine the results in one sheet. If your x axis points line up nicely enough, you can replot the data, for example, as in Figure 2B Compare these results with your own results. And make any plots that you feel help explain the environmental system behaviour. Big questions: which factors cause the differences between your results and those of the IPCC models? Submission Submit properly formatted graphs and tables of the following sections of the lab: Double log plot. Any number of plots that compare your Exercise 3 results with the IPCC data. The submission is to be all together in a word doc or PDF format. No screenshots of figures from Excel/Excel spreadsheets to be uploaded. General professional formatting guidelines: All figures are to have adequate captions explaining them For graphs, figure captions go below the plot For tables, the caption goes above the table Make sure figures and their text size is readable Excel hints: When there is a caption for a plot, you remove the title Remove the plot border and gridlines Make sure both axes have visible lines and tick marks Units need to be noted properly with the axis label - ‘Temperature (°C)’ Round numbers to be reasonable Appendix – Equation list \\[\\begin{gather*} {CO}_{2(\\text{gas})}\\rightleftarrows{CO}_{2(\\text{dissolved})} \\tag{28} \\\\ {CO}_{2(\\text{dissolved})}+H_{2}O\\rightleftarrows H_2{CO}_3 \\tag{29} \\\\ {CO}_{2(\\text{gas})}+H_2O\\rightleftarrows \\color{#ED7D31}{H_2CO_3^\\ast} \\hspace{3em} K_{H} = 3.39×10^{-2} \\tag{30} \\\\ \\color{#ED7D31}{H_2CO_3^\\ast}\\rightleftarrows \\color{#00B050}{HCO_3^-}+\\color{#FF0000}{H^+} \\hspace{3em} K_{1} = 5×10^{-7} \\tag{31} \\\\ \\color{#00B050}{HCO_3^-}\\rightleftarrows\\color{#5B9BD5}{{CO}_3^{2-}}+\\color{#FF0000}{H^+} \\hspace{3em} K_{2} = 5×10^{-11} \\tag{32} \\\\ C_T=[\\color{#00B050}{{HCO}_3^-}]+[\\color{#5B9BD5}{{CO}_3^{2-}}]+[\\color{#ED7D31}{H_2{CO}_3^\\ast}] \\tag{33} \\\\ [Alk]=[\\color{#00B050}{{HCO}_3^-}]+2[\\color{#5B9BD5}{{CO}_3^{2-}}]+[{OH}^-]-[\\color{#FF0000}{H^+}] \\tag{34} \\\\ [{OH}^-][\\color{#FF0000}{H^{+}}]=K_{W} \\hspace{3em} K_{W} = 1×10^{-14} \\tag{35} \\\\ [{OH}^-]=\\frac{K_{W}}{[\\color{#FF0000}{H+}]} \\tag{36} \\\\ {CO}_3^{2-}+{Ca}^{2+}\\rightleftarrows CaCO_3 \\hspace{3em} K_{sp} = 1\\times 10^{-8.4} \\tag{37} \\\\ \\mathrm{\\Omega}=[Ca^{2+}][CO_{3}^{2-}][K_{sp \\space CaCO_{3}}] \\tag{38} \\\\ {[\\color{#FF0000}{H^+}]^2C}_T=\\color{#ED7D31}{H_2{CO}_3^\\ast}([\\color{#FF0000}{H^+}]^2+K_1[\\color{#FF0000}{H^+}]+K_1K_2) \\tag{39} \\\\ [\\color{#FF0000}{H^+}]=\\sqrt[2]{\\frac{\\color{#ED7D31}{H_2{CO}_3^\\ast}}{C_T}([\\color{#FF0000}{H^+}]^2+K_1[\\color{#FF0000}{H^+}]+K_1K_2)} \\tag{40} \\\\ K_{1} = \\frac{[\\color{#FF0000}{H^{+}}][\\color{#00B050}{HCO_{3}^{-}}]}{[\\color{#C45911}{H_{2}CO_{3}]}} \\tag{41} \\\\ K_{2} = \\frac{[\\color{#FF0000}{H^{+}}][\\color{#5B9BD5}{CO_{3}^{2-}}]}{[\\color{#00B050}{HCO_{3}^{-}]}} \\tag{42} \\\\ K_{W} = \\frac{[\\color{#FF0000}{H^{+}}][OH^{-}]}{[H_{2}O]} \\tag{43} \\\\ K_{H} = \\frac{[\\color{#C45911}{H_{2}CO_{3}}][OH^{-}]}{[CO_{2}]} \\tag{44} \\\\ [\\color{#ED7D31}{H_{2}CO_{3}^{\\ast}}] = K_{H}CO_{2} = C_{T}\\alpha_{0} \\tag{45} \\\\ [\\color{#00B050}{HCO{3}^{-}}] = \\frac{K_{1}[\\color{#ED7D31}{H_{2}CO_{3}]}}{[\\color{#FF0000}{H^{+}}]} = C_{T}\\alpha_{1} \\text{ CHECK equation!} \\tag{46} \\\\ [\\color{#5B9BD5}{CO_{3}^{2-}}] = \\frac{K_{2}[\\color{#00B050}{HCO_{3}^{-}}]}{[\\color{#FF0000}{H^{+}}]} = C_{T}\\alpha_{2} \\tag{47} \\\\ \\Omega = \\frac{[Ca^{2+}][\\color{#5B9BD5}{CO_{3}^{2-}}]}{[K_{sp \\space CaCO_{3}}]} \\tag{48} \\\\ C_{T} = [HCO_{3}^{-}] + [CO_{3}^{2-}] + [H_{2}CO{3}^{\\ast}] \\tag{49} \\end{gather*}\\] \\[\\begin{align*} [Alk] &amp;= [HCO_{3}^{-}] + 2[CO_{3}^{2-}] + [OH^{-}] - [H^{+}] \\tag{50} \\\\ &amp;= C_{T}(\\alpha_{1}+2\\alpha_{2})+[OH^{-}]-[H^{+}] \\end{align*}\\] \\[\\begin{gather*} \\alpha_{0} = (1 + \\frac{K_{1}}{[\\color{#FF0000}{H^{+}}]} + \\frac{K_{1}K_{2}}{[\\color{#FF0000}{H^{+}}]^{2}}) \\tag{51} \\\\ \\end{gather*}\\] References "],
["module-5-catchment-water-balance.html", "Module 5: Catchment Water Balance", " Module 5: Catchment Water Balance "],
["module-6-land-use-and-nutrient-management.html", "Module 6: Land Use and Nutrient Management", " Module 6: Land Use and Nutrient Management "],
["module-7-advection-dispersion.html", "Module 7: Advection-Dispersion", " Module 7: Advection-Dispersion "],
["module-8-lake-water-quality-modelling.html", "Module 8: Lake Water Quality Modelling", " Module 8: Lake Water Quality Modelling "],
["references.html", "References", " References Harte, John. 1988. Consider a Spherical Cow: A Course in Environmental Problem Solving. University Science Books. Stumm, Werner, and JJ Morgan. 1996. “Chemical Equilibria and Rates in Natural Waters.” Aquatic Chemistry 1022. "]
]
